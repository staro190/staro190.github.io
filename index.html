<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Orbit of Learning</title>
  <link rel="stylesheet" href="./css/style.css">
  <style>
    body { margin:0; overflow-x:hidden; background:#000; color:#fff; font-family:sans-serif; }
    .center-menu { 
      position:absolute; 
      top:20%; /* 화면 중앙보다 조금 위로 */
      left:50%; 
      transform:translate(-50%, -50%); 
      text-align:center; 
      z-index:10; 
    }
    .center-menu h1 { font-size:3em; margin-bottom:20px; }
    .center-menu nav a { margin:0 15px; color:#fff; text-decoration:none; font-size:1.2em; }
    canvas { display:block; }
  </style>
</head>
<body>
  <!-- 배경 파티클 -->
  <canvas id="bg"></canvas>

  <!-- 중앙 메뉴 -->
  <div class="center-menu">
    <h1>Orbit of Learning</h1>
    <nav>
      <a href="about.html">About</a>
      <a href="cs_main.html">Computer Science</a>
      <a href="contact.html">Contact</a>
    </nav>
  </div>

  <!-- 하단 궤도 캔버스 -->
  <canvas id="orbitCanvas" style="position: fixed; bottom:10%; left:0; width:100%; height:300px; z-index:5;"></canvas>

  <!-- 배경 파티클 JS -->
  <script>
    const bgCanvas = document.getElementById('bg');
    const bgCtx = bgCanvas.getContext('2d');
    let particles = [];

    function initCanvas(){
      bgCanvas.width = window.innerWidth;
      bgCanvas.height = window.innerHeight;
      initParticles();
    }

    function initParticles(){
      particles = [];
      const particleCount = 80;
      for(let i=0;i<particleCount;i++){
        particles.push({
          x: Math.random()*bgCanvas.width,
          y: Math.random()*bgCanvas.height,
          vx: (Math.random()-0.5)*0.5,
          vy: (Math.random()-0.5)*0.5,
          size: Math.random()*2 + 1
        });
      }
    }

    function drawParticles(){
      bgCtx.clearRect(0,0,bgCanvas.width,bgCanvas.height);
      bgCtx.fillStyle = "#00d4ff";
      particles.forEach(p=>{
        p.x += p.vx;
        p.y += p.vy;

        if(p.x<0) p.x=bgCanvas.width;
        if(p.x>bgCanvas.width) p.x=0;
        if(p.y<0) p.y=bgCanvas.height;
        if(p.y>bgCanvas.height) p.y=0;

        bgCtx.beginPath();
        bgCtx.arc(p.x,p.y,p.size,0,Math.PI*2);
        bgCtx.fill();
      });
      requestAnimationFrame(drawParticles);
    }

    window.addEventListener('resize', initCanvas);
    initCanvas();
    drawParticles();
  </script>

  <!-- 하단 궤도 + 아이콘 JS -->
  <script>
    const orbitCanvas = document.getElementById('orbitCanvas');
    const oCtx = orbitCanvas.getContext('2d');

    let centerX = orbitCanvas.width / 2;
    let centerY = orbitCanvas.height / 2;

    const orbits = [
      { radius: 70, speed: 0.02, angle: 0, icon: './img/neurology.png', link: 'ai.html' },     
      { radius: 130, speed: 0.015, angle: Math.PI/2, icon: './img/terminal.png', link: 'cs_main.html' },
      { radius: 200, speed: 0.01, angle: Math.PI, icon: './img/shield.png', link: 'cyber.html' }
    ];

    orbits.forEach(o=>{
      const img = new Image();
      img.src = o.img;
      o.imageObj = img;
    });
    
    //const colors = ['#4dd0e1', '#d291ff', '#ffdf70']; // 낮은 채도
    const colors = [
      'rgba(0, 100, 150, 0.7)',    // 청색 계열
      'rgba(150, 50, 150, 0.7)',   // 보라 계열
      'rgba(180, 140, 0, 0.7)'     // 금색 계열
    ];


    let mouseX = -1000, mouseY = -1000;
    let isPaused = false;

    orbitCanvas.addEventListener('mousemove', (e)=>{
      const rect = orbitCanvas.getBoundingClientRect();
      mouseX = e.clientX - rect.left;
      mouseY = e.clientY - rect.top;
    });

    orbitCanvas.addEventListener('mouseenter', ()=>{ isPaused = true; });
    orbitCanvas.addEventListener('mouseleave', ()=>{
      isPaused = false;
      mouseX = -1000; mouseY = -1000;
    });

    function drawOrbit() {
      oCtx.clearRect(0,0,orbitCanvas.width, orbitCanvas.height);

      orbits.forEach((o,i)=>{
        // 궤도 원
        oCtx.beginPath();
        oCtx.strokeStyle = 'rgba(255,255,255,0.2)';
        oCtx.arc(centerX, centerY, o.radius, 0, Math.PI*2);
        oCtx.stroke();

        // 점 위치
        const x = centerX + o.radius * Math.cos(o.angle);
        const y = centerY + o.radius * Math.sin(o.angle);

        // 점(행성)
        oCtx.shadowColor = colors[i%colors.length]; // 각 점 색과 동일하게
        oCtx.shadowBlur = 15;
        oCtx.beginPath();
        oCtx.arc(x, y, 20, 0, Math.PI*2); // 점 크기 10
        oCtx.fillStyle = colors[i % colors.length];
        oCtx.fill();

        // 글로우 해제
        oCtx.shadowColor = 'transparent';
        oCtx.shadowBlur = 0;

        // 아이콘 마우스 오버 확대 + 글로우
        const distance = Math.hypot(mouseX - x, mouseY - y);
        let iconSize = 25; // 기본 아이콘 작게

        // 아이콘 글로우 초기화
        oCtx.shadowColor = 'transparent';
        oCtx.shadowBlur = 0;
        if(distance < 32){
          iconSize = 38; // 마우스 오버 시 확대
          oCtx.shadowColor = '#fff';
          oCtx.shadowBlur = 10;
        }

        // Material Icon 그리기
        oCtx.drawImage(o.imageObj, x, y, 32, 32);
        oCtx.textAlign = 'center';
        oCtx.textBaseline = 'middle';
        oCtx.fillStyle = '#fff';
        oCtx.fillText(o.icon, x, y);

        // 회전 업데이트
        if(!isPaused) o.angle += o.speed;
      });

      requestAnimationFrame(drawOrbit);
    }

    drawOrbit();

    // 클릭 이벤트
    orbitCanvas.addEventListener('click', (e)=>{
      const rect = orbitCanvas.getBoundingClientRect();
      const clickX = e.clientX - rect.left;
      const clickY = e.clientY - rect.top;

      orbits.forEach(o=>{
        const x = centerX + o.radius * Math.cos(o.angle);
        const y = centerY + o.radius * Math.sin(o.angle);
        const distance = Math.hypot(clickX - x, clickY - y);
        if(distance < 24){
          window.location.href = o.link;
        }
      });
    });

    function resizeOrbitCanvas() {
      const dpr = window.devicePixelRatio || 1;
    
      // CSS 기준 크기
      const canvasWidth = 450;
      const canvasHeight = 450;      // 원하는 높이
      const canvasBottom = 100;      // 화면 하단에서 띄울 거리
    
      orbitCanvas.width = canvasWidth * dpr;
      orbitCanvas.height = canvasHeight * dpr;
      orbitCanvas.style.width = canvasWidth + 'px';
      orbitCanvas.style.height = canvasHeight + 'px';
      orbitCanvas.style.bottom = canvasBottom + 'px';
      orbitCanvas.style.left = '50%';
      orbitCanvas.style.transform = 'translateX(-50%)';

    
      // DPI 보정
      oCtx.setTransform(1, 0, 0, 1, 0, 0);
      oCtx.scale(dpr, dpr);
    
      // 중심 좌표 (캔버스 내부 좌표 기준)
      centerX = canvasWidth / 2;
      centerY = canvasHeight / 2;
    }
    
    // 초기화
    resizeOrbitCanvas();
    window.addEventListener('resize', resizeOrbitCanvas);

  </script>
</body>
</html>
